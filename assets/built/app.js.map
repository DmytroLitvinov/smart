{"version":3,"file":"app.js","sources":["../js/app/colorModeToggle.js","../js/app/copy.js","../js/app/saves.js","../js/app/clickHandler.js","../js/app/keyHandler.js","../js/app/pagination.js","../js/app/app.js"],"sourcesContent":["/*\n * Color mode toggle\n */\n\nexport function toggleColorMode(color) {\n  document.documentElement.setAttribute('data-color-pref', color);\n  localStorage.setItem('pref', color);\n}\n\nexport function determineColorModeSupport() {\n  const colorPrefButtons = document.querySelectorAll('.sm-dark-mode, .sm-light-mode');\n\n  const hasSupport = window.CSS && CSS.supports('color', 'var(--primary)');\n\n  // If the browser doesn't support custom settings, hide buttons\n  if (!hasSupport) {\n    colorPrefButtons.forEach((e) => {\n      e.style.display = 'none';\n    });\n  }\n}\n","function updateCopyButtonState() {\n  const copyButtons = document.querySelectorAll('.sm-copy-button');\n  copyButtons.forEach((el) => {\n    el.classList.toggle('sm-copy-button--copied');\n    setTimeout(() => {\n      el.classList.toggle('sm-copy-button--copied');\n    }, 3000);\n  });\n}\nexport default async function copyToClipboard() {\n  const currentURL = window.location.href;\n  await navigator.clipboard.writeText(currentURL);\n  updateCopyButtonState();\n}\n","export class Saves {\n  constructor(e) {\n    this.id = (e && e.dataset.id) || null;\n    this.title = (e && e.dataset.title) || null;\n    this.items = () =>\n      Saves.makeArray(JSON.parse(localStorage.getItem('saves')));\n    this.int = null;\n  }\n\n  generateItem() {\n    return {\n      id: this.id,\n      title: this.title,\n      timestamp: new Date(),\n      scrollPos: this.scrollStatus().scrollPos,\n      progress: this.scrollStatus().progress,\n    };\n  }\n\n  save() {\n    localStorage.setItem(\n      'saves',\n      JSON.stringify([this.generateItem(), ...this.items()]),\n    );\n\n    this.populateSavesMenu();\n    this.updateScrollPosition();\n\n    const els = document.querySelectorAll(`button[data-id=${this.id}]`);\n    els.forEach((el) => {\n      el.classList.add('sm-love-toggle');\n    });\n  }\n\n  remove() {\n    const items = [...this.items()];\n    const itemIndex = items.findIndex((el) => this.id === el.id);\n    items.splice(itemIndex, 1);\n    localStorage.removeItem('saves');\n    if (items.length) {\n      localStorage.setItem('saves', JSON.stringify(items));\n    }\n\n    this.int = null;\n    this.populateSavesMenu();\n\n    const els = document.querySelectorAll(`button[data-id=${this.id}]`);\n    els.forEach((el) => {\n      el.classList.remove('sm-love-toggle');\n    });\n  }\n\n  static makeArray(data) {\n    if (!data) return [];\n    return data.length ? data : [data];\n  }\n\n  scrollStatus() {\n    if (this.isCurrentPageSaved() < 0) {\n      return {\n        scrollPos: null,\n        progress: null,\n      };\n    }\n    return {\n      scrollPos: window.scrollY,\n      progress: Math.round(\n        (window.scrollY /\n          (document.body.scrollHeight - document.body.clientHeight)) *\n          100,\n      ),\n    };\n  }\n\n  identifySaves() {\n    if (!this.items()) return;\n\n    this.items().forEach((el) => {\n      const { id } = el;\n      const domEl = document.querySelectorAll(`button[data-id=${id}]`);\n      if (domEl) {\n        domEl.forEach((button) => button.classList.add('sm-love-toggle'));\n      }\n    });\n  }\n\n  isCurrentPageSaved() {\n    const currentPage = window.location.pathname.replace(/\\//g, '');\n    return this.items().findIndex((item) => item.id === currentPage);\n  }\n\n  step() {\n    const itemIndex = this.isCurrentPageSaved();\n    if (itemIndex < 0) {\n      return;\n    }\n\n    const items = this.items();\n    items[itemIndex].progress = this.scrollStatus().progress;\n    items[itemIndex].scrollPos = this.scrollStatus().scrollPos;\n    localStorage.removeItem('saves');\n    localStorage.setItem('saves', JSON.stringify(items));\n    this.populateSavesMenu();\n\n    setTimeout(() => {\n      window.requestAnimationFrame(this.step.bind(this));\n    }, 1000);\n  }\n\n  updateScrollPosition() {\n    const items = this.items();\n    if (!items.length) return;\n    const itemIndex = this.isCurrentPageSaved();\n\n    if (itemIndex < 0) {\n      return;\n    }\n\n    window.requestAnimationFrame(this.step.bind(this));\n  }\n\n  scrollToPos() {\n    if (this.isCurrentPageSaved() > -1) {\n      const items = this.items();\n      window.scrollTo({\n        top: items[this.isCurrentPageSaved()].scrollPos,\n        behavior: 'smooth',\n      });\n    }\n  }\n\n  renderSavesMenu() {\n    const template = this.items().map(\n      (el) =>\n        `<div class=\"sm-saves\" style=\"background-image: linear-gradient(to right, hsla(\n          var(--primary-h) var(--saturation) var(--lightness) / ${\n            el.progress ? 0.35 : 0.15\n          }\n        ) ${el.progress ? el.progress - 10 : 50}%, hsla(\n          var(--primary-h) var(--saturation) var(--lightness) / 0.15\n        ) ${el.progress ? el.progress + 10 : 50}%\">\n            <div class=\"sm-saves-meta\">\n                <div>\n                    <p class=\"sm-saves-title\"><a href=\"/${el.id}\">${\n          el.title\n        }</a></p>\n                    <p class=\"sm-saves-date\">Saved on ${new Intl.DateTimeFormat().format(\n                      new Date(el.timestamp),\n                    )}</p>\n                </div>\n                <button class=\"sm-circle-icon-button sm-love-button sm-love-toggle\" data-id=\"${\n                  el.id\n                }\" data-title=\"${el.title}\" aria-label=\"Remove ${\n          el.title\n        } from favorites\">\n                <svg class=\"sm-heart-outline-icon\"><use href=\"#sm-heart-outline-icon\"></use></svg>\n                <svg class=\"sm-heart-fill-icon\"><use href=\"#sm-heart-fill-icon\"></use></svg>\n                </button>\n            </div>\n        </div>`,\n    );\n    return template.join('');\n  }\n\n  populateSavesMenu() {\n    const savesMenu = document.querySelector('.sm-overflow-articles');\n\n    if (!this.items().length) {\n      const noSavesText =\n        '<p>No articles saved yet. Hit the heart to get started!</p>';\n      savesMenu.innerHTML = noSavesText;\n      return;\n    }\n    savesMenu.innerHTML = this.renderSavesMenu();\n  }\n\n  init() {\n    this.identifySaves();\n    this.populateSavesMenu();\n    this.scrollToPos();\n    this.updateScrollPosition();\n  }\n}\n\nexport function save(e) {\n  const savedItems = new Saves(e);\n\n  const items = savedItems.items();\n\n  if (!items.length) {\n    savedItems.save();\n    return;\n  }\n\n  const { id } = savedItems;\n\n  if (items.find((el) => el.id === id)) {\n    savedItems.remove();\n  } else {\n    savedItems.save();\n  }\n}\n","import { toggleColorMode } from './colorModeToggle';\nimport copyToClipboard from './copy';\nimport { save } from './saves';\n\nfunction handleClick(e) {\n  if (e.target.closest('.sm-navbar-menu-button')) {\n    document\n      .querySelector('.sm-nav-menu-container')\n      .classList.add('sm-show-menu');\n  }\n\n  if (e.target.closest('.sm-love-button')) {\n    save(e.target.closest('.sm-love-button'));\n    // e.target.closest('.sm-love-button').classList.toggle('sm-love-toggle');\n    return;\n  }\n\n  if (e.target.closest('.sm-nav-menu-close-button')) {\n    document\n      .querySelector('.sm-nav-menu-container')\n      .classList.remove('sm-show-menu');\n  }\n\n  if (e.target.closest('.sm-copy-button')) {\n    copyToClipboard(e.target.closest('.sm-copy-button'));\n    return;\n  }\n\n  if (e.target.closest('.sm-dark-mode')) {\n    toggleColorMode('dark');\n    return;\n  }\n\n  if (e.target.closest('.sm-light-mode')) {\n    toggleColorMode('light');\n    return;\n  }\n\n  if (\n    e.target.closest('.sm-saves-button') ||\n    e.target.closest('.sm-navbar-close-saves')\n  ) {\n    document\n      .querySelector('.sm-navbar-saves')\n      .classList.toggle('sm-show-saves');\n  }\n}\n\nexport default function eventHandler() {\n  document.body.addEventListener('click', handleClick);\n}\n","function handleClick(e) {\n  if (e.code === 'Escape') {\n    document.querySelector('[class*=show]');\n  }\n}\n\nexport default function keyClickHandler() {\n  document.body.addEventListener('keyup', handleClick);\n}\n","function pathnameParser(pathname) {\n  if (!/page/.test(pathname)) {\n    return pathname;\n  }\n\n  return pathname.split('page')[0];\n}\n\nfunction navButtonFormatter(nextOrPrevEl, nextOrPrevName, paginationEl) {\n  const icon = nextOrPrevName === 'previous' ? 'left' : 'right';\n  const className = nextOrPrevName === 'previous' ? 'sm-prev' : 'sm-next';\n\n  const navButton = nextOrPrevEl\n    ? document.createElement('a')\n    : document.createElement('span');\n  navButton.innerHTML = `<svg aria-hidden=\"true\"><use href=\"#sm-${icon}-arrow-icon\"></use></svg>`;\n  navButton.classList.add('sm-circle-icon-button', className);\n\n  if (nextOrPrevEl) {\n    navButton.setAttribute('aria-label', `${nextOrPrevName} posts`);\n    navButton.setAttribute('href', nextOrPrevEl);\n  } else {\n    navButton.classList.add('sm-circle-icon-button', 'sm-nav-disabled');\n  }\n\n  paginationEl.append(navButton);\n}\n\nexport default function generatePagination() {\n  const pagination = document.querySelector('.sm-pagination');\n\n  if (!pagination) return;\n  const pathname = pathnameParser(window.location.pathname);\n  const { page, prev, next, pages } = pagination.dataset;\n\n  navButtonFormatter(prev, 'previous', pagination);\n\n  const paginationStart = page - 2 > 0 ? page - 2 : 1;\n\n  for (\n    let index = paginationStart - 1;\n    index < Math.min(paginationStart + 4, +pages);\n    index += 1\n  ) {\n    let urlPath;\n\n    if (index === 0 && pathname === '/') {\n      urlPath = '/';\n    } else if (index === 0 && pathname !== '/') {\n      urlPath = pathname;\n    } else {\n      urlPath = `${pathname}page/${index + 1}/`;\n    }\n\n    const div = document.createElement('div');\n    div.classList.add('sm-pagination-item');\n    const a = document.createElement('a');\n    a.setAttribute('href', urlPath);\n    a.textContent = index + 1;\n\n    if (+page === index + 1) {\n      div.classList.add('sm-current');\n    }\n    div.append(a);\n    pagination.append(div);\n  }\n\n  navButtonFormatter(next, 'next', pagination);\n}\n","import '../../css/app/index.css';\n\nimport initClickHandler from './clickHandler';\nimport animateNavbar from './navbarAnimation';\nimport { determineColorModeSupport } from './colorModeToggle';\nimport keyClickHandler from './keyHandler';\nimport generatePagination from './pagination';\nimport { Saves } from './saves';\n\ninitClickHandler();\n// animateNavbar();\ndetermineColorModeSupport();\ngeneratePagination();\nkeyClickHandler();\nnew Saves().init();\n"],"names":["toggleColorMode","color","document","documentElement","setAttribute","localStorage","setItem","async","copyToClipboard","currentURL","window","location","href","navigator","clipboard","writeText","querySelectorAll","forEach","el","classList","toggle","setTimeout","Saves","constructor","e","this","id","dataset","title","items","makeArray","JSON","parse","getItem","int","generateItem","timestamp","Date","scrollPos","scrollStatus","progress","save","stringify","populateSavesMenu","updateScrollPosition","add","remove","itemIndex","findIndex","splice","removeItem","length","static","data","isCurrentPageSaved","scrollY","Math","round","body","scrollHeight","clientHeight","identifySaves","domEl","button","currentPage","pathname","replace","item","step","requestAnimationFrame","bind","scrollToPos","scrollTo","top","behavior","renderSavesMenu","map","Intl","DateTimeFormat","format","join","savesMenu","querySelector","innerHTML","noSavesText","init","handleClick","target","closest","savedItems","find","code","navButtonFormatter","nextOrPrevEl","nextOrPrevName","paginationEl","icon","className","navButton","createElement","append","addEventListener","colorPrefButtons","CSS","supports","style","display","determineColorModeSupport","pagination","test","split","pathnameParser","page","prev","next","pages","paginationStart","index","min","urlPath","div","a","textContent","generatePagination"],"mappings":"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"}